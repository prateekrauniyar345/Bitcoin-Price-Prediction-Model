<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Price Predictor</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #f7931a;
            --primary-dark: #e8850f;
            --secondary: #4a90a4;
            --bg-dark: #1a1a2e;
            --bg-card: #16213e;
            --bg-input: #0f3460;
            --text-light: #ffffff;
            --text-muted: #a0a0a0;
            --success: #00c853;
            --danger: #ff5252;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0f0f23 100%);
            color: var(--text-light);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary) 0%, #ffd700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header p {
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .bitcoin-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        select, textarea, input {
            width: 100%;
            padding: 14px;
            border: 2px solid transparent;
            border-radius: 10px;
            background: var(--bg-input);
            color: var(--text-light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        select:focus, textarea:focus, input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(247, 147, 26, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }

        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--text-light);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(247, 147, 26, 0.3);
        }

        .btn-secondary {
            background: var(--bg-input);
            color: var(--text-light);
            border: 2px solid var(--secondary);
        }

        .btn-secondary:hover {
            background: var(--secondary);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .result-card {
            background: linear-gradient(135deg, rgba(247, 147, 26, 0.1) 0%, rgba(74, 144, 164, 0.1) 100%);
            border: 2px solid var(--primary);
            display: none;
        }

        .result-card.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .prediction-value {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
            margin: 20px 0;
        }

        .prediction-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .detail-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .detail-item .label {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 5px;
        }

        .detail-item .value {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .positive { color: var(--success); }
        .negative { color: var(--danger); }

        .info-box {
            background: rgba(74, 144, 164, 0.2);
            border-left: 4px solid var(--secondary);
            padding: 15px;
            border-radius: 0 10px 10px 0;
            margin: 20px 0;
            font-size: 0.9rem;
        }

        .info-box i {
            color: var(--secondary);
            margin-right: 8px;
        }

        .model-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .model-option {
            padding: 15px;
            background: var(--bg-input);
            border-radius: 10px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .model-option:hover {
            border-color: var(--primary);
        }

        .model-option.selected {
            border-color: var(--primary);
            background: rgba(247, 147, 26, 0.1);
        }

        .model-option h4 {
            color: var(--primary);
            margin-bottom: 5px;
        }

        .model-option p {
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(247, 147, 26, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: rgba(255, 82, 82, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        /* Collapsible Section Styles */
        .collapsible-section {
            margin-bottom: 20px;
        }

        .collapsible-header {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px 30px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .collapsible-header:hover {
            border-color: var(--primary);
        }

        .collapsible-header h2 {
            color: var(--primary);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0;
        }

        .collapsible-header .toggle-icon {
            font-size: 1.2rem;
            color: var(--primary);
            transition: transform 0.3s ease;
        }

        .collapsible-header.active .toggle-icon {
            transform: rotate(180deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.4s ease;
            background: var(--bg-card);
            border-radius: 0 0 16px 16px;
            margin-top: -16px;
            padding: 0 30px;
            border: 1px solid transparent;
        }

        .collapsible-content.active {
            max-height: 2000px;
            padding: 30px;
            border-color: rgba(255, 255, 255, 0.1);
            border-top: none;
        }

        .model-detail-card {
            background: var(--bg-input);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .model-detail-card:last-child {
            margin-bottom: 0;
        }

        .model-detail-card h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .model-detail-card h3 .badge {
            background: var(--success);
            color: white;
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 20px;
            font-weight: normal;
        }

        .model-specs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .spec-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 12px;
            border-radius: 8px;
        }

        .spec-item .spec-label {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 4px;
        }

        .spec-item .spec-value {
            color: var(--text-light);
            font-weight: 600;
        }

        .model-description {
            color: var(--text-muted);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-requirements {
            background: rgba(74, 144, 164, 0.15);
            border-left: 3px solid var(--secondary);
            padding: 12px 15px;
            border-radius: 0 8px 8px 0;
            margin-top: 15px;
        }

        .data-requirements h4 {
            color: var(--secondary);
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .data-requirements ul {
            margin: 0;
            padding-left: 20px;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .data-requirements li {
            margin-bottom: 4px;
        }

        footer {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        footer a {
            color: var(--primary);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 600px) {
            header h1 {
                font-size: 1.8rem;
            }
            
            .prediction-value {
                font-size: 2rem;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .collapsible-header {
                padding: 15px 20px;
            }

            .collapsible-content.active {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <i class="fab fa-bitcoin bitcoin-icon"></i>
            <h1>Bitcoin Price Predictor</h1>
            <p>LSTM/GRU Deep Learning Model for Next-Day Price Prediction</p>
        </header>

        <!-- Collapsible Model Information Section -->
        <div class="collapsible-section">
            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <h2><i class="fas fa-info-circle"></i> Model Information & Documentation</h2>
                <i class="fas fa-chevron-down toggle-icon"></i>
            </div>
            <div class="collapsible-content">
                <!-- LSTM v2 Model -->
                <div class="model-detail-card">
                    <h3>
                        <i class="fas fa-brain"></i> LSTM v2 
                        <span class="badge">RECOMMENDED</span>
                    </h3>
                    <div class="model-specs">
                        <div class="spec-item">
                            <div class="spec-label">Architecture</div>
                            <div class="spec-value">2-Layer LSTM</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Units per Layer</div>
                            <div class="spec-value">128 units</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Dropout Rate</div>
                            <div class="spec-value">0.7 (70%)</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Training Epochs</div>
                            <div class="spec-value">100 epochs</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Batch Size</div>
                            <div class="spec-value">64</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Optimizer</div>
                            <div class="spec-value">Adam (lr=0.001)</div>
                        </div>
                    </div>
                    <div class="model-description">
                        <strong>Description:</strong> This is the recommended model with higher dropout (0.7) to reduce overfitting. 
                        LSTM (Long Short-Term Memory) networks are excellent for capturing long-term dependencies in time series data. 
                        The higher dropout rate helps the model generalize better to unseen data, making predictions more reliable.
                    </div>
                    <div class="data-requirements">
                        <h4>Input Data Requirements:</h4>
                        <ul>
                            <li><strong>50 consecutive daily closing prices</strong> (in USD)</li>
                            <li>Prices should be ordered from oldest to newest</li>
                            <li>Data is automatically scaled using MinMaxScaler</li>
                            <li>Predicts the next day's closing price</li>
                        </ul>
                    </div>
                </div>

                <!-- LSTM v1 Model -->
                <div class="model-detail-card">
                    <h3><i class="fas fa-brain"></i> LSTM v1</h3>
                    <div class="model-specs">
                        <div class="spec-item">
                            <div class="spec-label">Architecture</div>
                            <div class="spec-value">2-Layer LSTM</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Units per Layer</div>
                            <div class="spec-value">128 units</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Dropout Rate</div>
                            <div class="spec-value">0.5 (50%)</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Training Epochs</div>
                            <div class="spec-value">100 epochs</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Batch Size</div>
                            <div class="spec-value">64</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Optimizer</div>
                            <div class="spec-value">Adam (lr=0.001)</div>
                        </div>
                    </div>
                    <div class="model-description">
                        <strong>Description:</strong> The standard LSTM model with moderate dropout (0.5). 
                        This version may fit the training data more closely but could be slightly more prone to overfitting 
                        compared to v2. Good for cases where you want the model to capture more subtle patterns in the data.
                    </div>
                    <div class="data-requirements">
                        <h4>Input Data Requirements:</h4>
                        <ul>
                            <li><strong>50 consecutive daily closing prices</strong> (in USD)</li>
                            <li>Prices should be ordered from oldest to newest</li>
                            <li>Data is automatically scaled using MinMaxScaler</li>
                            <li>Predicts the next day's closing price</li>
                        </ul>
                    </div>
                </div>

                <!-- GRU v1 Model -->
                <div class="model-detail-card">
                    <h3><i class="fas fa-microchip"></i> GRU v1</h3>
                    <div class="model-specs">
                        <div class="spec-item">
                            <div class="spec-label">Architecture</div>
                            <div class="spec-value">2-Layer GRU</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Units per Layer</div>
                            <div class="spec-value">64 units</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Dropout Rate</div>
                            <div class="spec-value">0.5 (50%)</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Training Epochs</div>
                            <div class="spec-value">100 epochs</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Batch Size</div>
                            <div class="spec-value">32</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Optimizer</div>
                            <div class="spec-value">Adam (lr=0.001)</div>
                        </div>
                    </div>
                    <div class="model-description">
                        <strong>Description:</strong> GRU (Gated Recurrent Unit) is a simpler variant of LSTM with fewer parameters. 
                        This model uses 64 units per layer, making it faster for inference. While GRU models are computationally 
                        more efficient, LSTM typically performs better for financial time series with complex long-term dependencies.
                        Use this model when speed is a priority.
                    </div>
                    <div class="data-requirements">
                        <h4>Input Data Requirements:</h4>
                        <ul>
                            <li><strong>50 consecutive daily closing prices</strong> (in USD)</li>
                            <li>Prices should be ordered from oldest to newest</li>
                            <li>Data is automatically scaled using MinMaxScaler</li>
                            <li>Predicts the next day's closing price</li>
                        </ul>
                    </div>
                </div>

                <!-- General Information -->
                <div class="model-detail-card" style="background: rgba(247, 147, 26, 0.1);">
                    <h3><i class="fas fa-database"></i> Training Data Information</h3>
                    <div class="model-description" style="border: none; padding-top: 0; margin-top: 0;">
                        <p><strong>Data Source:</strong> Historical Bitcoin price data (OHLCV - Open, High, Low, Close, Volume)</p>
                        <p style="margin-top: 10px;"><strong>Data Processing:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px; color: var(--text-muted);">
                            <li>1-minute data resampled to daily intervals</li>
                            <li>Close price extracted as the primary feature</li>
                            <li>Data normalized using MinMaxScaler (0 to 1 range)</li>
                            <li>80% training / 20% testing split</li>
                        </ul>
                        <p style="margin-top: 15px;"><strong>Important Notes:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px; color: var(--text-muted);">
                            <li>This model predicts based on historical patterns only</li>
                            <li>Cryptocurrency markets are highly volatile and unpredictable</li>
                            <li>Predictions should not be used as financial advice</li>
                            <li>Past performance does not guarantee future results</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2><i class="fas fa-robot"></i> Select Model</h2>
            <div class="model-info">
                <div class="model-option selected" data-model="lstm_v2" onclick="selectModel(this)">
                    <h4>LSTM v2 (Recommended)</h4>
                    <p>128 units, 0.7 dropout - Best generalization</p>
                </div>
                <div class="model-option" data-model="lstm_v1" onclick="selectModel(this)">
                    <h4>LSTM v1</h4>
                    <p>128 units, 0.5 dropout - Standard model</p>
                </div>
                <div class="model-option" data-model="gru_v1" onclick="selectModel(this)">
                    <h4>GRU v1</h4>
                    <p>64 units, 0.5 dropout - Faster inference</p>
                </div>
            </div>
        </div>

        <div class="card">
            <h2><i class="fas fa-chart-line"></i> Input Data</h2>
            
            <div class="info-box">
                <i class="fas fa-info-circle"></i>
                Enter <strong>50 daily closing prices</strong> (comma-separated) to predict the next day's price.
                You can also load the most recent historical data.
            </div>

            <div class="form-group">
                <label for="prices">Daily Closing Prices (50 values)</label>
                <textarea id="prices" placeholder="Enter 50 comma-separated daily closing prices...&#10;Example: 42000, 42500, 43000, ..."></textarea>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="loadRecentPrices()">
                    <i class="fas fa-history"></i> Load Recent Data
                </button>
                <button class="btn btn-secondary" onclick="loadSampleData()">
                    <i class="fas fa-flask"></i> Load Sample Data
                </button>
                <button class="btn btn-secondary" onclick="clearData()">
                    <i class="fas fa-trash"></i> Clear
                </button>
            </div>
        </div>

        <div class="card">
            <button class="btn btn-primary" onclick="predict()" id="predictBtn" style="width: 100%;">
                <i class="fas fa-brain"></i> Predict Next Day's Price
            </button>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Running prediction model...</p>
            </div>

            <div class="error-message" id="error"></div>
        </div>

        <div class="card result-card" id="result">
            <h2><i class="fas fa-chart-bar"></i> Prediction Result</h2>
            
            <div class="prediction-value">
                $<span id="predictedPrice">0.00</span>
            </div>

            <div class="prediction-details">
                <div class="detail-item">
                    <div class="label">Model Used</div>
                    <div class="value" id="modelUsed">-</div>
                </div>
                <div class="detail-item">
                    <div class="label">Last Input Price</div>
                    <div class="value">$<span id="lastPrice">0.00</span></div>
                </div>
                <div class="detail-item">
                    <div class="label">Price Change</div>
                    <div class="value" id="priceChange">$0.00</div>
                </div>
                <div class="detail-item">
                    <div class="label">Change %</div>
                    <div class="value" id="priceChangePct">0.00%</div>
                </div>
            </div>
        </div>

        <footer>
            <p>Built with TensorFlow & Flask</p>
            <p><a href="/health">API Health Check</a> | <a href="/api/models">Available Models</a></p>
        </footer>
    </div>

    <script>
        let selectedModel = 'lstm_v2';

        function toggleCollapsible(header) {
            header.classList.toggle('active');
            const content = header.nextElementSibling;
            content.classList.toggle('active');
        }

        function selectModel(element) {
            document.querySelectorAll('.model-option').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            selectedModel = element.dataset.model;
        }

        function loadRecentPrices() {
            fetch('/api/recent-prices')
                .then(response => response.json())
                .then(data => {
                    if (data.prices) {
                        document.getElementById('prices').value = data.prices.map(p => p.toFixed(2)).join(', ');
                    } else {
                        showError(data.error || 'Failed to load recent prices');
                    }
                })
                .catch(err => showError('Failed to fetch recent prices'));
        }

        function loadSampleData() {
            // Sample Bitcoin prices (approximate values for demonstration)
            const samplePrices = [
                42150, 42300, 42100, 41900, 42000, 42200, 42500, 42800, 43000, 43200,
                43100, 42900, 42700, 42800, 43000, 43300, 43500, 43400, 43200, 43100,
                43300, 43600, 43800, 44000, 44200, 44100, 43900, 43700, 43800, 44000,
                44300, 44500, 44700, 44600, 44400, 44200, 44300, 44500, 44800, 45000,
                45200, 45100, 44900, 44700, 44800, 45000, 45300, 45500, 45700, 45600
            ];
            document.getElementById('prices').value = samplePrices.join(', ');
        }

        function clearData() {
            document.getElementById('prices').value = '';
            document.getElementById('result').classList.remove('show');
            document.getElementById('error').classList.remove('show');
        }

        function showError(message) {
            const errorEl = document.getElementById('error');
            errorEl.textContent = message;
            errorEl.classList.add('show');
        }

        function hideError() {
            document.getElementById('error').classList.remove('show');
        }

        async function predict() {
            hideError();
            
            const pricesText = document.getElementById('prices').value.trim();
            
            if (!pricesText) {
                showError('Please enter price data or load recent data');
                return;
            }

            const prices = pricesText.split(',').map(p => parseFloat(p.trim())).filter(p => !isNaN(p));
            
            if (prices.length !== 50) {
                showError(`Please enter exactly 50 prices. You entered ${prices.length} prices.`);
                return;
            }

            // Show loading
            document.getElementById('loading').classList.add('show');
            document.getElementById('predictBtn').disabled = true;
            document.getElementById('result').classList.remove('show');

            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        prices: prices,
                        model: selectedModel
                    })
                });

                const data = await response.json();

                if (data.success) {
                    document.getElementById('predictedPrice').textContent = data.predicted_price.toLocaleString();
                    document.getElementById('modelUsed').textContent = data.model_used.toUpperCase();
                    document.getElementById('lastPrice').textContent = data.last_input_price.toLocaleString();
                    
                    const changeEl = document.getElementById('priceChange');
                    const changePctEl = document.getElementById('priceChangePct');
                    
                    changeEl.textContent = (data.price_change >= 0 ? '+$' : '-$') + Math.abs(data.price_change).toLocaleString();
                    changeEl.className = 'value ' + (data.price_change >= 0 ? 'positive' : 'negative');
                    
                    changePctEl.textContent = (data.price_change_pct >= 0 ? '+' : '') + data.price_change_pct + '%';
                    changePctEl.className = 'value ' + (data.price_change_pct >= 0 ? 'positive' : 'negative');
                    
                    document.getElementById('result').classList.add('show');
                } else {
                    showError(data.error || 'Prediction failed');
                }
            } catch (err) {
                showError('Failed to connect to server: ' + err.message);
            } finally {
                document.getElementById('loading').classList.remove('show');
                document.getElementById('predictBtn').disabled = false;
            }
        }

        // Check server health on load
        fetch('/health')
            .then(response => response.json())
            .then(data => {
                console.log('Server status:', data);
                if (data.models_loaded.length === 0) {
                    showError('Warning: No models are loaded. Please check the server.');
                }
            })
            .catch(err => {
                showError('Cannot connect to server. Please ensure the Flask app is running.');
            });
    </script>
</body>
</html>
